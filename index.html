<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WebGPU Shaded Particle Spheres</title>
    <style>
      html, body {
        margin: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: #0b0f14;
      }
      canvas {
        width: 100%;
        height: 100%;
        display: block;
      }
      #gizmo {
        position: absolute;
        inset: 0;
        pointer-events: auto;
        z-index: 1;
      }
      .hint {
        position: absolute;
        left: 72px;
        top: 12px;
        color: #cdd6e0;
        font: 10px/1.4 "SF Mono", Menlo, monospace;
        opacity: 0.7;
        pointer-events: none;
      }
      /* Sidebar */
      .settings-sidebar {
        position: fixed;
        left: 12px;
        bottom: 12px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        z-index: 100;
      }
      .sidebar-btn {
        width: 44px;
        height: 44px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.3);
        color: #9fb0c2;
        font: 600 16px/1 "SF Mono", Menlo, monospace;
        cursor: pointer;
        transition: background 120ms ease, border-color 120ms ease, color 120ms ease;
        backdrop-filter: blur(16px) saturate(180%);
        -webkit-backdrop-filter: blur(16px) saturate(180%);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 8px;
      }
      .sidebar-btn svg {
        width: 100%;
        height: 100%;
      }
      /* Particles - Red (top) */
      .sidebar-btn[data-panel="particles"] {
        background: rgba(239, 68, 68, 0.2);
        border-color: rgba(239, 68, 68, 0.5);
        color: #f87171;
      }
      .sidebar-btn[data-panel="particles"]:hover {
        background: rgba(239, 68, 68, 0.3);
        border-color: rgba(239, 68, 68, 0.6);
      }
      .sidebar-btn[data-panel="particles"].active {
        background: rgba(239, 68, 68, 0.35);
        border-color: rgba(239, 68, 68, 0.7);
        color: #fca5a5;
      }
      /* Emitter - Hot Pink */
      .sidebar-btn[data-panel="emitter"] {
        background: rgba(236, 72, 153, 0.2);
        border-color: rgba(236, 72, 153, 0.5);
        color: #f472b6;
      }
      .sidebar-btn[data-panel="emitter"]:hover {
        background: rgba(236, 72, 153, 0.3);
        border-color: rgba(236, 72, 153, 0.6);
      }
      .sidebar-btn[data-panel="emitter"].active {
        background: rgba(236, 72, 153, 0.35);
        border-color: rgba(236, 72, 153, 0.7);
        color: #fbcfe8;
      }
      /* Forces - Purple */
      .sidebar-btn[data-panel="forces"] {
        background: rgba(168, 85, 247, 0.2);
        border-color: rgba(168, 85, 247, 0.5);
        color: #a78bfa;
      }
      .sidebar-btn[data-panel="forces"]:hover {
        background: rgba(168, 85, 247, 0.3);
        border-color: rgba(168, 85, 247, 0.6);
      }
      .sidebar-btn[data-panel="forces"].active {
        background: rgba(168, 85, 247, 0.35);
        border-color: rgba(168, 85, 247, 0.7);
        color: #c4b5fd;
      }
      /* Shading - Blue */
      .sidebar-btn[data-panel="shading"] {
        background: rgba(59, 130, 246, 0.2);
        border-color: rgba(59, 130, 246, 0.5);
        color: #60a5fa;
      }
      .sidebar-btn[data-panel="shading"]:hover {
        background: rgba(59, 130, 246, 0.3);
        border-color: rgba(59, 130, 246, 0.6);
      }
      .sidebar-btn[data-panel="shading"].active {
        background: rgba(59, 130, 246, 0.35);
        border-color: rgba(59, 130, 246, 0.7);
        color: #bfdbfe;
      }
      /* Camera - Teal (bottom) */
      .sidebar-btn[data-panel="camera"] {
        background: rgba(20, 184, 166, 0.2);
        border-color: rgba(20, 184, 166, 0.5);
        color: #5eead4;
      }
      .sidebar-btn[data-panel="camera"]:hover {
        background: rgba(20, 184, 166, 0.3);
        border-color: rgba(20, 184, 166, 0.6);
      }
      .sidebar-btn[data-panel="camera"].active {
        background: rgba(20, 184, 166, 0.35);
        border-color: rgba(20, 184, 166, 0.7);
        color: #a7f3d0;
      }
      /* Panel container */
      .settings-panel-container {
        position: fixed;
        left: 68px;
        bottom: 12px;
        max-height: calc(100vh - 24px);
        overflow-y: auto;
        z-index: 99;
      }
      .settings-panel-container::-webkit-scrollbar {
        width: 6px;
      }
      .settings-panel-container::-webkit-scrollbar-track {
        background: transparent;
      }
      .settings-panel-container::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.15);
        border-radius: 3px;
      }
      .settings-panel-container .panel {
        display: none;
        width: 260px;
      }
      .settings-panel-container .panel.active {
        display: block;
      }
      .panel {
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        color: #d6e0ea;
        font: 11.5px/1.3 "SF Mono", Menlo, monospace;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.35);
        backdrop-filter: blur(16px) saturate(180%);
        -webkit-backdrop-filter: blur(16px) saturate(180%);
      }
      /* Particles - Red (top) */
      .panel[data-panel="particles"] {
        background: rgba(239, 68, 68, 0.2);
        border-color: rgba(239, 68, 68, 0.5);
      }
      /* Emitter - Hot Pink */
      .panel[data-panel="emitter"] {
        background: rgba(236, 72, 153, 0.2);
        border-color: rgba(236, 72, 153, 0.5);
      }
      /* Forces - Purple */
      .panel[data-panel="forces"] {
        background: rgba(168, 85, 247, 0.2);
        border-color: rgba(168, 85, 247, 0.5);
      }
      /* Shading - Blue */
      .panel[data-panel="shading"] {
        background: rgba(59, 130, 246, 0.2);
        border-color: rgba(59, 130, 246, 0.5);
      }
      /* Camera - Teal (bottom) */
      .panel[data-panel="camera"] {
        background: rgba(20, 184, 166, 0.2);
        border-color: rgba(20, 184, 166, 0.5);
      }
      .panel-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 12px;
        user-select: none;
        border-bottom: 2px solid rgba(255, 255, 255, 0.2);
      }
      /* Colored panel headers */
      .panel[data-panel="particles"] .panel-header {
        border-bottom-color: rgba(239, 68, 68, 0.4);
      }
      .panel[data-panel="emitter"] .panel-header {
        border-bottom-color: rgba(236, 72, 153, 0.4);
      }
      .panel[data-panel="forces"] .panel-header {
        border-bottom-color: rgba(168, 85, 247, 0.4);
      }
      .panel[data-panel="shading"] .panel-header {
        border-bottom-color: rgba(59, 130, 246, 0.4);
      }
      .panel[data-panel="camera"] .panel-header {
        border-bottom-color: rgba(20, 184, 166, 0.4);
      }
      /* Colored collapse indicators */
      .panel[data-panel="particles"] .collapse-indicator {
        border-color: rgba(239, 68, 68, 0.5);
        color: rgba(239, 68, 68, 0.9);
      }
      .panel[data-panel="particles"] .collapse-indicator:hover {
        border-color: rgba(239, 68, 68, 0.7);
        background: rgba(239, 68, 68, 0.15);
      }
      .panel[data-panel="emitter"] .collapse-indicator {
        border-color: rgba(236, 72, 153, 0.5);
        color: rgba(236, 72, 153, 0.9);
      }
      .panel[data-panel="emitter"] .collapse-indicator:hover {
        border-color: rgba(236, 72, 153, 0.7);
        background: rgba(236, 72, 153, 0.15);
      }
      .panel[data-panel="forces"] .collapse-indicator {
        border-color: rgba(168, 85, 247, 0.5);
        color: rgba(168, 85, 247, 0.9);
      }
      .panel[data-panel="forces"] .collapse-indicator:hover {
        border-color: rgba(168, 85, 247, 0.7);
        background: rgba(168, 85, 247, 0.15);
      }
      .panel[data-panel="shading"] .collapse-indicator {
        border-color: rgba(59, 130, 246, 0.5);
        color: rgba(59, 130, 246, 0.9);
      }
      .panel[data-panel="shading"] .collapse-indicator:hover {
        border-color: rgba(59, 130, 246, 0.7);
        background: rgba(59, 130, 246, 0.15);
      }
      .panel[data-panel="camera"] .collapse-indicator {
        border-color: rgba(20, 184, 166, 0.5);
        color: rgba(20, 184, 166, 0.9);
      }
      .panel[data-panel="camera"] .collapse-indicator:hover {
        border-color: rgba(20, 184, 166, 0.7);
        background: rgba(20, 184, 166, 0.15);
      }
      .panel-header span {
        font-weight: 600;
        letter-spacing: 0.02em;
      }
      .panel-content {
        padding: 10px 12px 14px;
        display: grid;
        gap: 10px;
      }
      .control {
        display: grid;
        gap: 6px;
      }
      .select-control {
        margin-bottom: 0;
      }
      .control-stack {
        display: grid;
        gap: 10px;
      }
      .control label {
        display: flex;
        align-items: center;
        font-size: 10.5px;
        color: #9fb0c2;
      }
      .setting > label {
        cursor: pointer;
      }
      .label-left {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        flex: 1;
        min-width: 0;
      }
      .collapse-indicator {
        width: 14px;
        height: 14px;
        border-radius: 50%;
        border: 1px solid rgba(255, 255, 255, 0.3);
        background: rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.8);
        font-size: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 120ms ease;
        padding: 0;
        margin: 0;
        flex-shrink: 0;
        box-sizing: border-box;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        vertical-align: middle;
        line-height: 1;
      }
      .collapse-indicator span {
        display: block;
        margin-top: -2px;
      }
      .collapse-indicator:hover {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.4);
      }
      .setting.expanded .collapse-indicator {
        /* Text changes handled by JS */
      }
      .setting .control-body {
        display: none;
        gap: 6px;
      }
      .setting.expanded .control-body {
        display: grid;
      }
      .setting.expanded .control-body.range-body {
        grid-template-columns: 1fr 28px;
        align-items: center;
      }
      .setting.expanded .control-body.range-body input[type="range"] {
        grid-column: 1 / -1;
        width: 100%;
      }
      .value-row {
        display: flex;
        align-items: center;
        gap: 6px;
        grid-column: 1 / -1;
      }
      .value-row .editable-value {
        margin-left: 0;
      }
      .value-row .reset-btn {
        margin-left: 0;
      }
      .editable-value {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-left: auto;
        padding: 1px 6px;
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.08);
        color: #d6e0ea;
        cursor: ew-resize;
        min-width: 36px;
      }
      .editable-value.editing {
        background: rgba(255, 255, 255, 0.16);
        cursor: text;
        outline: none;
      }
      .control input[type="range"] {
        width: 100%;
      }
      .control input[type="color"] {
        width: 100%;
        height: 28px;
        border: none;
        background: transparent;
        padding: 0;
      }
      .control select {
        width: 100%;
        background: rgba(255, 255, 255, 0.08);
        color: #d6e0ea;
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 6px;
        padding: 5px 7px;
        font: 10.5px/1.2 "SF Mono", Menlo, monospace;
      }
      .direction-control {
        align-items: start;
      }
      .direction-values {
        display: inline-flex;
        gap: 6px;
        margin-left: 6px;
        color: #cfd8e3;
        font-size: 11px;
      }
      .rotation-group .direction-3d {
        grid-template-columns: repeat(3, 1fr);
      }
      .rotation-axis {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
      }
      .axis-label {
        font-weight: 600;
        font-size: 11px;
        opacity: 0.8;
      }
      .rotation-axis .direction-wheel {
        margin: 0;
      }
      .rotation-axis .direction-values {
        font-size: 11px;
        font-weight: 600;
      }
      .rotation-axis .direction-reset {
        margin: 0;
      }
      .direction-reset {
        margin-left: 6px;
      }
      .direction-wheel {
        position: relative;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background:
          radial-gradient(circle at center, rgba(86, 156, 255, 0.2), rgba(12, 18, 26, 0.95) 60%),
          linear-gradient(transparent 49%, rgba(255, 255, 255, 0.12) 50%, transparent 51%),
          linear-gradient(90deg, transparent 49%, rgba(255, 255, 255, 0.12) 50%, transparent 51%);
        border: 1px solid rgba(255, 255, 255, 0.12);
        box-shadow: inset 0 0 18px rgba(0, 0, 0, 0.45);
        justify-self: start;
        cursor: pointer;
        touch-action: none;
      }
      .direction-3d {
        display: grid;
        gap: 10px;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        align-items: start;
      }
      .direction-wheel::after {
        content: "";
        position: absolute;
        inset: 6px;
        border-radius: 50%;
        border: 1px dashed rgba(255, 255, 255, 0.12);
      }
      .direction-wheel-dot {
        position: absolute;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #56a3ff;
        border: 1px solid #0b0f14;
        box-shadow: 0 0 8px rgba(86, 156, 255, 0.6);
        transform: translate(-50%, -50%);
        /* Initial position at top (0 degrees) */
        left: 50%;
        top: 10%;
      }
      .curve-editor {
        width: 100%;
        height: 90px;
        border-radius: 8px;
        background: rgba(6, 10, 16, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.08);
        cursor: crosshair;
      }
      .gradient-editor {
        width: 100%;
        height: 36px;
        border-radius: 8px;
        background: rgba(6, 10, 16, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.08);
        cursor: pointer;
      }
      .pill-toggle {
        justify-self: start;
        min-width: 64px;
        padding: 4px 12px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        background: transparent;
        color: #cfd8e3;
        font: 11px/1.2 "SF Mono", Menlo, monospace;
        cursor: pointer;
        transition: background 120ms ease, border-color 120ms ease, color 120ms ease;
      }
      .pill-toggle[data-state="on"] {
        background: rgba(86, 156, 255, 0.85);
        border-color: rgba(86, 156, 255, 0.95);
        color: #0b0f14;
      }
      .reset-btn {
        justify-self: end;
        width: 22px;
        height: 22px;
        padding: 0;
        border-radius: 6px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(255, 255, 255, 0.06);
        color: #cfd8e3;
        font: 14px/1 "SF Mono", Menlo, monospace;
        cursor: pointer;
        display: grid;
        place-items: center;
        text-align: center;
      }
      .reset-btn:hover {
        background: rgba(255, 255, 255, 0.12);
      }
      
      /* Mobile Full-Screen Settings */
      @media (max-width: 768px) {
        /* Sidebar - touch-friendly buttons */
        .settings-sidebar {
          position: fixed;
          bottom: 12px;
          left: 12px;
          flex-direction: row;
          gap: 10px;
          z-index: 1000;
        }
        .sidebar-btn {
          width: 44px;
          height: 44px;
          font-size: 18px;
        }
        
        /* Panel container - full screen overlay */
        .settings-panel-container {
          position: fixed;
          inset: 0;
          display: flex;
          align-items: flex-start;
          justify-content: center;
          padding: 16px;
          padding-top: 56px;
          padding-bottom: 72px;
          z-index: 999;
          background: transparent;
          pointer-events: none;
        }
        .settings-panel-container .panel {
          pointer-events: auto;
        }
        
        
        /* Panel - full width, no background */
        .settings-panel-container .panel {
          width: 100%;
          max-width: 100%;
          height: calc(100vh - 140px);
          background: transparent !important;
          border: none !important;
          box-shadow: none;
          backdrop-filter: none;
          display: none;
          overflow-y: auto;
          pointer-events: auto;
        }
        .settings-panel-container .panel.active {
          display: block;
        }
        .panel-header {
          display: none;
        }
        
        /* Panel content - single column for better touch */
        .panel-content {
          display: flex;
          flex-direction: column;
          gap: 24px;
          padding: 0 12px;
          pointer-events: auto;
        }
        
        /* Control layout - label on top, input below */
        .control {
          display: flex;
          flex-direction: column;
          gap: 10px;
          width: 100%;
        }
        
        /* Labels - readable size, right-aligned value */
        .control label {
          font-size: 14px;
          font-weight: 500;
          min-height: 32px;
          display: flex;
          align-items: center;
          justify-content: space-between;
          width: 100%;
          letter-spacing: 0.3px;
          gap: 12px;
        }
        /* Value spans within labels - right aligned */
        .control label > span {
          font-weight: 600;
          margin-left: auto;
          text-align: right;
          flex-shrink: 0;
        }
        /* Nested spans (like direction-values) */
        .control label .direction-values {
          margin-left: auto;
        }
        
        /* Range inputs - touch-friendly track and thumb */
        .control input[type="range"] {
          width: 100%;
          height: 8px;
          -webkit-appearance: none;
          appearance: none;
          background: transparent;
          border: 2px solid;
          border-radius: 4px;
          margin: 8px 0;
        }
        .control input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          appearance: none;
          width: 28px;
          height: 28px;
          border: 3px solid;
          border-radius: 50%;
          background: transparent;
          cursor: pointer;
        }
        .control input[type="range"]::-moz-range-thumb {
          width: 28px;
          height: 28px;
          border: 3px solid;
          border-radius: 50%;
          background: transparent;
          cursor: pointer;
        }
        .control input[type="range"]::-moz-range-track {
          height: 8px;
          background: transparent;
          border: 2px solid;
          border-radius: 4px;
        }
        
        /* Color inputs - touch-friendly */
        .control input[type="color"] {
          width: 100%;
          height: 44px;
          border: 2px solid;
          border-radius: 8px;
          background: transparent;
        }
        
        /* Selects - touch-friendly */
        .control select {
          width: 100%;
          height: 44px;
          border: 2px solid;
          background: transparent;
          font-size: 14px;
          padding: 8px 12px;
          border-radius: 8px;
        }
        
        /* Direction wheels - large touch targets */
        .direction-wheel {
          width: 80px;
          height: 80px;
          background: transparent;
          border: 2px solid;
          box-shadow: none;
          flex-shrink: 0;
        }
        .direction-wheel::after {
          border: 1px dashed;
        }
        .direction-wheel-dot {
          width: 20px;
          height: 20px;
          border: 3px solid;
          background: transparent;
          box-shadow: none;
          /* Initial position at top (0 degrees) */
          left: 50%;
          top: 10%;
        }
        
        /* Reset buttons - touch target */
        .reset-btn {
          width: 44px;
          height: 44px;
          border: 2px solid;
          background: transparent;
          font-size: 18px;
          flex-shrink: 0;
        }
        
        /* Pill toggles - touch-friendly */
        .pill-toggle {
          min-width: 64px;
          height: 44px;
          border: 2px solid;
          background: transparent;
          font-size: 12px;
          padding: 8px 16px;
          border-radius: 22px;
          color: rgba(255, 255, 255, 0.6);
        }
        .pill-toggle[data-state="on"] {
          background: transparent;
          border-width: 3px;
        }
        /* Pill toggle "on" state colors per category */
        .panel[data-panel="particles"] .pill-toggle[data-state="on"] {
          color: rgba(239, 68, 68, 0.95);
          border-color: rgba(239, 68, 68, 0.7);
        }
        .panel[data-panel="emitter"] .pill-toggle[data-state="on"] {
          color: rgba(236, 72, 153, 0.95);
          border-color: rgba(236, 72, 153, 0.7);
        }
        .panel[data-panel="forces"] .pill-toggle[data-state="on"] {
          color: rgba(168, 85, 247, 0.95);
          border-color: rgba(168, 85, 247, 0.7);
        }
        .panel[data-panel="shading"] .pill-toggle[data-state="on"] {
          color: rgba(59, 130, 246, 0.95);
          border-color: rgba(59, 130, 246, 0.7);
        }
        .panel[data-panel="camera"] .pill-toggle[data-state="on"] {
          color: rgba(20, 184, 166, 0.95);
          border-color: rgba(20, 184, 166, 0.7);
        }
        
        /* Curve editors - visible size */
        .curve-editor {
          width: 100%;
          height: 80px;
          background: transparent;
          border: 2px solid;
          border-radius: 8px;
        }
        .gradient-editor {
          width: 100%;
          height: 44px;
          background: transparent;
          border: 2px solid;
          border-radius: 8px;
        }
        
        /* Rotation groups - collapsible */
        .rotation-group .direction-3d {
          display: flex;
          flex-direction: row;
          justify-content: space-around;
          gap: 16px;
          width: 100%;
          padding: 8px 0;
        }
        
        /* Rotation axis - vertical column with wheel */
        .rotation-axis {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 8px;
          flex: 1;
        }
        .rotation-axis .axis-label {
          font-size: 14px;
          font-weight: 600;
        }
        .rotation-axis .direction-values {
          font-size: 16px;
          font-weight: 700;
        }
        .rotation-axis .direction-reset {
          width: 36px;
          height: 36px;
          font-size: 16px;
          margin: 0;
        }
        .rotation-axis .direction-wheel {
          margin: 0;
        }
        
        /* Control stacks */
        .control-stack {
          display: flex;
          flex-direction: column;
          gap: 20px;
        }
        
        /* Select controls with adjacent buttons */
        .select-control {
          flex-direction: row;
          flex-wrap: wrap;
          align-items: center;
          gap: 12px;
        }
        .select-control label {
          width: 100%;
        }
        .select-control select {
          flex: 1;
          min-width: 0;
        }
        
        /* Editable values - touch-friendly inline display */
        .editable-value {
          border: 2px solid;
          background: transparent;
          min-height: 36px;
          min-width: 50px;
          padding: 6px 10px;
          font-size: 14px;
          font-weight: 600;
          border-radius: 6px;
          text-align: center;
          display: inline-flex;
          align-items: center;
          justify-content: center;
        }
        
        /* Value spans within labels */
        .control label span[id$="Val"] {
          margin-left: auto;
        }
        
        /* Collapse indicators - match text height on mobile */
        .collapse-indicator {
          width: 18px;
          height: 18px;
          border-radius: 50%;
          border: 2px solid rgba(255, 255, 255, 0.3);
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.9);
          font-size: 12px;
          font-weight: 600;
          cursor: pointer;
          transition: all 120ms ease;
          padding: 0;
          margin: 0;
          flex-shrink: 0;
          box-sizing: border-box;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          vertical-align: middle;
          line-height: 1;
        }
        .collapse-indicator span {
          display: block;
          margin-top: -2px;
        }
        .collapse-indicator:hover {
          background: rgba(255, 255, 255, 0.15);
          border-color: rgba(255, 255, 255, 0.4);
        }
        
        /* Collapsible settings - touch-friendly */
        .setting {
          position: relative;
        }
        .setting > label {
          cursor: pointer;
          -webkit-tap-highlight-color: transparent;
          touch-action: manipulation;
          user-select: none;
          min-height: 44px;
          padding: 8px 0;
        }
        .setting .control-body {
          display: none;
          flex-direction: column;
          gap: 12px;
          width: 100%;
          padding-top: 12px;
        }
        .setting.expanded .control-body {
          display: flex;
        }
        .value-row {
          display: flex;
          align-items: center;
          gap: 12px;
          justify-content: flex-start;
        }
        .value-row .editable-value {
          min-width: 60px;
        }
        .value-row .reset-btn {
          margin-left: 0;
        }
        
        /* === CATEGORY COLORS === */
        
        /* Particles - Red */
        .panel[data-panel="particles"] label {
          color: rgba(239, 68, 68, 0.95);
        }
        .panel[data-panel="particles"] input[type="range"],
        .panel[data-panel="particles"] input[type="color"],
        .panel[data-panel="particles"] select,
        .panel[data-panel="particles"] .direction-wheel,
        .panel[data-panel="particles"] .reset-btn,
        .panel[data-panel="particles"] .pill-toggle,
        .panel[data-panel="particles"] .curve-editor,
        .panel[data-panel="particles"] .gradient-editor,
        .panel[data-panel="particles"] .editable-value {
          border-color: rgba(239, 68, 68, 0.5);
        }
        .panel[data-panel="particles"] input[type="range"]::-webkit-slider-thumb,
        .panel[data-panel="particles"] input[type="range"]::-moz-range-thumb,
        .panel[data-panel="particles"] .direction-wheel-dot {
          border-color: rgba(239, 68, 68, 0.8);
        }
        .panel[data-panel="particles"] .editable-value {
          color: rgba(239, 68, 68, 0.95);
        }
        .panel[data-panel="particles"] .collapse-indicator {
          border-color: rgba(239, 68, 68, 0.5);
          color: rgba(239, 68, 68, 0.9);
        }
        .panel[data-panel="particles"] .collapse-indicator:hover {
          border-color: rgba(239, 68, 68, 0.7);
          background: rgba(239, 68, 68, 0.15);
        }
        
        /* Emitter - Hot Pink */
        .panel[data-panel="emitter"] label {
          color: rgba(236, 72, 153, 0.95);
        }
        .panel[data-panel="emitter"] input[type="range"],
        .panel[data-panel="emitter"] input[type="color"],
        .panel[data-panel="emitter"] select,
        .panel[data-panel="emitter"] .direction-wheel,
        .panel[data-panel="emitter"] .reset-btn,
        .panel[data-panel="emitter"] .pill-toggle,
        .panel[data-panel="emitter"] .curve-editor,
        .panel[data-panel="emitter"] .gradient-editor,
        .panel[data-panel="emitter"] .editable-value {
          border-color: rgba(236, 72, 153, 0.5);
        }
        .panel[data-panel="emitter"] input[type="range"]::-webkit-slider-thumb,
        .panel[data-panel="emitter"] input[type="range"]::-moz-range-thumb,
        .panel[data-panel="emitter"] .direction-wheel-dot {
          border-color: rgba(236, 72, 153, 0.8);
        }
        .panel[data-panel="emitter"] .editable-value {
          color: rgba(236, 72, 153, 0.95);
        }
        .panel[data-panel="emitter"] .collapse-indicator {
          border-color: rgba(236, 72, 153, 0.5);
          color: rgba(236, 72, 153, 0.9);
        }
        .panel[data-panel="emitter"] .collapse-indicator:hover {
          border-color: rgba(236, 72, 153, 0.7);
          background: rgba(236, 72, 153, 0.15);
        }
        
        /* Forces - Purple */
        .panel[data-panel="forces"] label {
          color: rgba(168, 85, 247, 0.95);
        }
        .panel[data-panel="forces"] input[type="range"],
        .panel[data-panel="forces"] input[type="color"],
        .panel[data-panel="forces"] select,
        .panel[data-panel="forces"] .direction-wheel,
        .panel[data-panel="forces"] .reset-btn,
        .panel[data-panel="forces"] .pill-toggle,
        .panel[data-panel="forces"] .curve-editor,
        .panel[data-panel="forces"] .gradient-editor,
        .panel[data-panel="forces"] .editable-value {
          border-color: rgba(168, 85, 247, 0.5);
        }
        .panel[data-panel="forces"] input[type="range"]::-webkit-slider-thumb,
        .panel[data-panel="forces"] input[type="range"]::-moz-range-thumb,
        .panel[data-panel="forces"] .direction-wheel-dot {
          border-color: rgba(168, 85, 247, 0.8);
        }
        .panel[data-panel="forces"] .editable-value {
          color: rgba(168, 85, 247, 0.95);
        }
        .panel[data-panel="forces"] .collapse-indicator {
          border-color: rgba(168, 85, 247, 0.5);
          color: rgba(168, 85, 247, 0.9);
        }
        .panel[data-panel="forces"] .collapse-indicator:hover {
          border-color: rgba(168, 85, 247, 0.7);
          background: rgba(168, 85, 247, 0.15);
        }
        
        /* Shading - Blue */
        .panel[data-panel="shading"] label {
          color: rgba(59, 130, 246, 0.95);
        }
        .panel[data-panel="shading"] input[type="range"],
        .panel[data-panel="shading"] input[type="color"],
        .panel[data-panel="shading"] select,
        .panel[data-panel="shading"] .direction-wheel,
        .panel[data-panel="shading"] .reset-btn,
        .panel[data-panel="shading"] .pill-toggle,
        .panel[data-panel="shading"] .curve-editor,
        .panel[data-panel="shading"] .gradient-editor,
        .panel[data-panel="shading"] .editable-value {
          border-color: rgba(59, 130, 246, 0.5);
        }
        .panel[data-panel="shading"] input[type="range"]::-webkit-slider-thumb,
        .panel[data-panel="shading"] input[type="range"]::-moz-range-thumb,
        .panel[data-panel="shading"] .direction-wheel-dot {
          border-color: rgba(59, 130, 246, 0.8);
        }
        .panel[data-panel="shading"] .editable-value {
          color: rgba(59, 130, 246, 0.95);
        }
        .panel[data-panel="shading"] .collapse-indicator {
          border-color: rgba(59, 130, 246, 0.5);
          color: rgba(59, 130, 246, 0.9);
        }
        .panel[data-panel="shading"] .collapse-indicator:hover {
          border-color: rgba(59, 130, 246, 0.7);
          background: rgba(59, 130, 246, 0.15);
        }
        
        /* DoF - Teal */
        .panel[data-panel="camera"] label {
          color: rgba(20, 184, 166, 0.95);
        }
        .panel[data-panel="camera"] input[type="range"],
        .panel[data-panel="camera"] input[type="color"],
        .panel[data-panel="camera"] select,
        .panel[data-panel="camera"] .direction-wheel,
        .panel[data-panel="camera"] .reset-btn,
        .panel[data-panel="camera"] .pill-toggle,
        .panel[data-panel="camera"] .curve-editor,
        .panel[data-panel="camera"] .gradient-editor,
        .panel[data-panel="camera"] .editable-value {
          border-color: rgba(20, 184, 166, 0.5);
        }
        .panel[data-panel="camera"] input[type="range"]::-webkit-slider-thumb,
        .panel[data-panel="camera"] input[type="range"]::-moz-range-thumb,
        .panel[data-panel="camera"] .direction-wheel-dot {
          border-color: rgba(20, 184, 166, 0.8);
        }
        .panel[data-panel="camera"] .editable-value {
          color: rgba(20, 184, 166, 0.95);
        }
        .panel[data-panel="camera"] .collapse-indicator {
          border-color: rgba(20, 184, 166, 0.5);
          color: rgba(20, 184, 166, 0.9);
        }
        .panel[data-panel="camera"] .collapse-indicator:hover {
          border-color: rgba(20, 184, 166, 0.7);
          background: rgba(20, 184, 166, 0.15);
        }
      }
    </style>
  </head>
  <body>
    <canvas id="gfx"></canvas>
    <canvas id="gizmo"></canvas>
    <div class="settings-sidebar">
      <button class="sidebar-btn" data-panel="particles" title="Particles">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <circle cx="6" cy="8" r="2.5"/>
          <circle cx="12" cy="5" r="1.5"/>
          <circle cx="17" cy="9" r="3"/>
          <circle cx="8" cy="15" r="1.8"/>
          <circle cx="15" cy="17" r="2.2"/>
          <circle cx="19" cy="14" r="1.2"/>
          <circle cx="4" cy="18" r="1"/>
        </svg>
      </button>
      <button class="sidebar-btn" data-panel="emitter" title="Emitter">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.2"/>
          <!-- Top -->
          <line x1="12" y1="9" x2="12" y2="4" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="12" cy="2.5" r="1.3"/>
          <!-- Top-right -->
          <line x1="14" y1="10" x2="18" y2="5" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="19.5" cy="3.5" r="1"/>
          <!-- Right -->
          <line x1="15" y1="12" x2="20" y2="12" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="21.5" cy="12" r="1.2"/>
          <!-- Bottom-right -->
          <line x1="14" y1="14" x2="17" y2="18" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="18.5" cy="20" r="1.1"/>
          <!-- Bottom -->
          <line x1="12" y1="15" x2="12" y2="19" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="12" cy="21" r="1.3"/>
          <!-- Bottom-left -->
          <line x1="10" y1="14" x2="6" y2="18" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="4.5" cy="20" r="1"/>
          <!-- Left -->
          <line x1="9" y1="12" x2="4" y2="12" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="2.5" cy="12" r="1.2"/>
          <!-- Top-left -->
          <line x1="10" y1="10" x2="6" y2="5" stroke="currentColor" stroke-width="0.8" opacity="0.5"/>
          <circle cx="4.5" cy="3.5" r="1.1"/>
        </svg>
      </button>
      <button class="sidebar-btn" data-panel="forces" title="Forces">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round">
          <path d="M2 6h12c2 0 3.5-1.5 3.5-3.5S15 0 13 1"/>
          <path d="M2 12h16c2.5 0 4 2 4 4s-2 3-4 2"/>
          <path d="M2 18h8c1.5 0 2.5 1 2.5 2.5s-1.5 2-3 1"/>
        </svg>
      </button>
      <button class="sidebar-btn" data-panel="shading" title="Shading">
        <svg viewBox="0 0 24 24">
          <defs>
            <linearGradient id="shadeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" stop-color="currentColor" stop-opacity="1"/>
              <stop offset="50%" stop-color="currentColor" stop-opacity="1"/>
              <stop offset="50%" stop-color="currentColor" stop-opacity="0.25"/>
              <stop offset="100%" stop-color="currentColor" stop-opacity="0.25"/>
            </linearGradient>
          </defs>
          <circle cx="12" cy="12" r="9" fill="url(#shadeGrad)"/>
        </svg>
      </button>
      <button class="sidebar-btn" data-panel="camera" title="Camera">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <rect x="3" y="8" width="12" height="10" rx="2"/>
          <circle cx="9" cy="13" r="3" fill="none" stroke="currentColor" stroke-width="1.5"/>
          <circle cx="9" cy="13" r="1"/>
          <path d="M15 10l5-3v10l-5-3z"/>
          <rect x="4" y="5" width="4" height="3" rx="1"/>
        </svg>
      </button>
    </div>
    <div class="settings-panel-container">
      <div class="panel" data-panel="particles">
        <div class="panel-header">
          <span>Particles</span>
        </div>
        <div class="panel-content">
          <div class="control select-control">
            <label for="particleShape">Particle Shape</label>
            <select id="particleShape">
              <option value="circle">Circle (2D)</option>
              <option value="square">Square (2D)</option>
              <option value="cube">Cube (3D)</option>
              <option value="sphere">Sphere (3D)</option>
              <option value="icosahedron">Icosahedron (3D)</option>
            </select>
          </div>
          <div id="spin2dControls" class="control-stack">
            <div class="control">
              <label for="spinRate2d">Spin Rate <span id="spinRate2dVal"></span></label>
              <input id="spinRate2d" type="range" min="-6" max="6" step="0.1" data-default="1.2" />
            </div>
          </div>
          <div id="spin3dControls" class="control-stack">
            <div class="control">
              <label for="spinRateX">Spin X <span id="spinRateXVal"></span></label>
              <input id="spinRateX" type="range" min="-6" max="6" step="0.1" data-default="1.2" />
            </div>
            <div class="control">
              <label for="spinRateY">Spin Y <span id="spinRateYVal"></span></label>
              <input id="spinRateY" type="range" min="-6" max="6" step="0.1" data-default="1.2" />
            </div>
            <div class="control">
              <label for="spinRateZ">Spin Z <span id="spinRateZVal"></span></label>
              <input id="spinRateZ" type="range" min="-6" max="6" step="0.1" data-default="1.2" />
            </div>
          </div>
          <div class="control">
            <label for="spinRandom">Spin Random <span id="spinRandomVal"></span></label>
            <input id="spinRandom" type="range" min="0" max="2" step="0.1" data-default="0.4" />
          </div>
          <div class="control">
            <label for="lifeSeconds">Life (sec) <span id="lifeSecondsVal"></span></label>
            <input id="lifeSeconds" type="range" min="0.4" max="4" step="0.1" data-default="2.0" />
          </div>
          <div class="control">
            <label for="lifeRandom">Life Random <span id="lifeRandomVal"></span></label>
            <input id="lifeRandom" type="range" min="0" max="1" step="0.05" data-default="0" />
          </div>
          <div class="control">
            <label for="particleSize">Particle Size <span id="particleSizeVal"></span></label>
            <input id="particleSize" type="range" min="1" max="500" step="1" data-default="1" />
          </div>
          <div class="control">
            <label for="sizeCurveCanvas">Size Curve</label>
            <canvas id="sizeCurveCanvas" class="curve-editor" width="240" height="90"></canvas>
          </div>
          <div class="control" id="gradientControl">
            <label for="colorGradientCanvas">Color Gradient</label>
            <canvas id="colorGradientCanvas" class="gradient-editor" width="240" height="36"></canvas>
          </div>
          <div class="control select-control">
            <label for="colorMode">Color Mode</label>
            <select id="colorMode">
              <option value="gradient">Gradient Over Life</option>
              <option value="random">Random From Gradient</option>
              <option value="solid">Solid Color</option>
            </select>
          </div>
          <div class="control" id="solidColorControl">
            <label for="solidColor">Solid Color <span id="solidColorVal"></span></label>
            <input id="solidColor" type="color" />
          </div>
          <div class="control">
            <label for="opacityCurveCanvas">Opacity Curve</label>
            <canvas id="opacityCurveCanvas" class="curve-editor" width="240" height="90"></canvas>
          </div>
          <div class="control select-control">
            <label for="blendMode">Blend Mode</label>
            <select id="blendMode">
              <option value="alpha">Normal</option>
              <option value="additive">Add</option>
              <option value="screen">Screen</option>
              <option value="multiply">Multiply</option>
            </select>
          </div>
          <div class="control" id="softnessControl">
            <label for="softness">Soft Particles <span id="softnessVal"></span></label>
            <input id="softness" type="range" min="0" max="1" step="0.05" data-default="0" />
          </div>
        </div>
      </div>

      <div class="panel" data-panel="emitter">
        <div class="panel-header">
          <span>Emitter</span>
        </div>
        <div class="panel-content">
          <div class="control select-control">
            <label for="emitMode">Emission Mode</label>
            <select id="emitMode">
              <option value="hold">On Click (Hold)</option>
              <option value="auto">Continuous</option>
            </select>
          </div>
          <div class="control select-control">
            <label for="emitterShape">Emitter Shape</label>
            <select id="emitterShape">
              <option value="point">Point</option>
              <option value="sphere">Sphere</option>
              <option value="box">Box</option>
              <option value="plane">Plane</option>
              <option value="line">Line</option>
            </select>
          </div>
          <div class="control">
            <label for="emitterGizmo">Show Emitter Gizmo</label>
            <button id="emitterGizmo" class="pill-toggle" type="button" data-state="off">Off</button>
          </div>
          <div class="control">
            <label for="emissionRate">Emission Rate <span id="emissionRateVal"></span></label>
            <input id="emissionRate" type="range" min="0" max="20000" step="1" data-default="40" />
          </div>
          <div id="emitterShapeControls" class="control-stack">
            <div class="control">
              <label for="emitterSize">Emitter Size <span id="emitterSizeVal"></span></label>
              <input id="emitterSize" type="range" min="0" max="1" step="0.02" data-default="0.2" />
            </div>
          <div class="control">
            <label for="emitterPosX">Emitter X <span id="emitterPosXVal"></span></label>
            <input id="emitterPosX" type="range" min="-2" max="2" step="0.05" data-default="0" />
          </div>
          <div class="control">
            <label for="emitterPosY">Emitter Y <span id="emitterPosYVal"></span></label>
            <input id="emitterPosY" type="range" min="-2" max="2" step="0.05" data-default="0" />
          </div>
          <div class="control">
            <label for="emitterPosZ">Emitter Z <span id="emitterPosZVal"></span></label>
            <input id="emitterPosZ" type="range" min="-2" max="2" step="0.05" data-default="0" />
          </div>
          <div class="control select-control">
            <label for="emitFrom">Emit From</label>
            <select id="emitFrom">
              <option value="volume">Volume</option>
              <option value="edge">Edge</option>
            </select>
          </div>
          </div>
          <div class="control rotation-group">
            <label>Emitter Rotation</label>
            <div id="direction3dControls" class="direction-3d">
              <div class="rotation-axis">
                <span class="axis-label">X</span>
                <div id="directionXWheel" class="direction-wheel" role="slider" aria-label="Rotate X">
                  <div id="directionXDot" class="direction-wheel-dot"></div>
                </div>
                <span class="direction-values"><span id="directionXVal"></span></span>
                <button id="directionXReset" type="button" class="reset-btn direction-reset">ø</button>
              </div>
              <div class="rotation-axis">
                <span class="axis-label">Y</span>
                <div id="directionYWheel" class="direction-wheel" role="slider" aria-label="Rotate Y">
                  <div id="directionYDot" class="direction-wheel-dot"></div>
                </div>
                <span class="direction-values"><span id="directionYVal"></span></span>
                <button id="directionYReset" type="button" class="reset-btn direction-reset">ø</button>
              </div>
              <div class="rotation-axis">
                <span class="axis-label">Z</span>
                <div id="directionZWheel" class="direction-wheel" role="slider" aria-label="Rotate Z">
                  <div id="directionZDot" class="direction-wheel-dot"></div>
                </div>
                <span class="direction-values"><span id="directionZVal"></span></span>
                <button id="directionZReset" type="button" class="reset-btn direction-reset">ø</button>
              </div>
            </div>
          </div>
          <div class="control">
            <label for="initialSpeed">Initial Speed <span id="initialSpeedVal"></span></label>
            <input id="initialSpeed" type="range" min="0" max="3" step="0.1" data-default="1" />
          </div>
          <div class="control">
            <label for="speedRandom">Speed Random <span id="speedRandomVal"></span></label>
            <input id="speedRandom" type="range" min="0" max="1" step="0.05" data-default="0.2" />
          </div>
          <div class="control">
            <label for="coneAngle">Cone Angle <span id="coneAngleVal"></span></label>
            <input id="coneAngle" type="range" min="0" max="90" step="1" data-default="16" />
          </div>
        </div>
      </div>

      <div class="panel" data-panel="forces">
        <div class="panel-header">
          <span>Forces</span>
        </div>
        <div class="panel-content">
          <div class="control">
            <label for="forcesEnabled">Forces</label>
            <button id="forcesEnabled" class="pill-toggle" type="button" data-state="on">On</button>
          </div>
          <div id="forcesControls" class="control-stack">
            <div class="control select-control">
              <label for="forceMode">Noise Mode</label>
              <select id="forceMode">
                <option value="turbulence">Turbulence</option>
                <option value="curl">Curl Noise</option>
              </select>
            </div>
            <div id="turbulenceControls" class="control-stack">
              <div class="control">
                <label for="turbulence">Turbulence <span id="turbulenceVal"></span></label>
                <input id="turbulence" type="range" min="0" max="100" step="0.1" data-default="1.2" />
              </div>
              <div class="control">
                <label for="turbulenceScale">Turbulence Scale <span id="turbulenceScaleVal"></span></label>
                <input id="turbulenceScale" type="range" min="0.1" max="100" step="0.1" data-default="0.8" />
              </div>
            </div>
            <div id="curlControls" class="control-stack">
              <div class="control">
                <label for="curlStrength">Curl Strength <span id="curlStrengthVal"></span></label>
                <input id="curlStrength" type="range" min="0" max="100" step="0.1" data-default="1.2" />
              </div>
              <div class="control">
                <label for="curlScale">Curl Scale <span id="curlScaleVal"></span></label>
                <input id="curlScale" type="range" min="0.1" max="100" step="0.1" data-default="0.8" />
              </div>
            </div>
            <div class="control">
              <label for="vortexEnabled">Vortex</label>
              <button id="vortexEnabled" class="pill-toggle" type="button" data-state="off">Off</button>
            </div>
            <div id="vortexControls" class="control-stack">
            <div class="control">
              <label for="vortexStrength">Vortex Strength <span id="vortexStrengthVal"></span></label>
              <input id="vortexStrength" type="range" min="0" max="100" step="0.1" data-default="1.8" />
            </div>
            <div class="control">
              <label for="vortexRadius">Vortex Radius <span id="vortexRadiusVal"></span></label>
              <input id="vortexRadius" type="range" min="0.1" max="100" step="0.1" data-default="1.5" />
            </div>
            <div class="control">
              <label for="vortexGizmo">Show Vortex Gizmo</label>
              <button id="vortexGizmo" class="pill-toggle" type="button" data-state="off">Off</button>
            </div>
            <div class="control">
              <label for="vortexPosX">Vortex X <span id="vortexPosXVal"></span></label>
              <input id="vortexPosX" type="range" min="-2" max="2" step="0.05" data-default="0" />
            </div>
            <div class="control">
              <label for="vortexPosY">Vortex Y <span id="vortexPosYVal"></span></label>
              <input id="vortexPosY" type="range" min="-2" max="2" step="0.05" data-default="0" />
            </div>
            <div class="control">
              <label for="vortexPosZ">Vortex Z <span id="vortexPosZVal"></span></label>
              <input id="vortexPosZ" type="range" min="-2" max="2" step="0.05" data-default="0" />
            </div>
            <div class="control rotation-group">
              <label>Vortex Rotation</label>
              <div class="direction-3d">
                <div class="rotation-axis">
                  <span class="axis-label">X</span>
                  <div id="vortexRotXWheel" class="direction-wheel" role="slider" aria-label="Rotate vortex X">
                    <div id="vortexRotXDot" class="direction-wheel-dot"></div>
                  </div>
                  <span class="direction-values"><span id="vortexRotXVal"></span></span>
                  <button id="vortexRotXReset" type="button" class="reset-btn direction-reset">ø</button>
                </div>
                <div class="rotation-axis">
                  <span class="axis-label">Y</span>
                  <div id="vortexRotYWheel" class="direction-wheel" role="slider" aria-label="Rotate vortex Y">
                    <div id="vortexRotYDot" class="direction-wheel-dot"></div>
                  </div>
                  <span class="direction-values"><span id="vortexRotYVal"></span></span>
                  <button id="vortexRotYReset" type="button" class="reset-btn direction-reset">ø</button>
                </div>
                <div class="rotation-axis">
                  <span class="axis-label">Z</span>
                  <div id="vortexRotZWheel" class="direction-wheel" role="slider" aria-label="Rotate vortex Z">
                    <div id="vortexRotZDot" class="direction-wheel-dot"></div>
                  </div>
                  <span class="direction-values"><span id="vortexRotZVal"></span></span>
                  <button id="vortexRotZReset" type="button" class="reset-btn direction-reset">ø</button>
                </div>
              </div>
            </div>
          </div>
            <div class="control">
              <label for="attractorEnabled">Attractor</label>
              <button id="attractorEnabled" class="pill-toggle" type="button" data-state="off">Off</button>
            </div>
            <div id="attractorControls" class="control-stack">
              <div class="control">
                <label for="attractorStrength">Attractor Strength <span id="attractorStrengthVal"></span></label>
                <input id="attractorStrength" type="range" min="0" max="100" step="0.1" data-default="0" />
              </div>
              <div class="control">
                <label for="attractorRadius">Attractor Radius <span id="attractorRadiusVal"></span></label>
                <input id="attractorRadius" type="range" min="0" max="100" step="0.1" data-default="0" />
              </div>
              <div class="control">
                <label for="attractorGizmo">Show Attractor Gizmo</label>
                <button id="attractorGizmo" class="pill-toggle" type="button" data-state="off">Off</button>
              </div>
              <div class="control">
                <label for="attractorPosX">Attractor X <span id="attractorPosXVal"></span></label>
                <input id="attractorPosX" type="range" min="-2" max="2" step="0.05" data-default="0" />
              </div>
              <div class="control">
                <label for="attractorPosY">Attractor Y <span id="attractorPosYVal"></span></label>
                <input id="attractorPosY" type="range" min="-2" max="2" step="0.05" data-default="0" />
              </div>
              <div class="control">
                <label for="attractorPosZ">Attractor Z <span id="attractorPosZVal"></span></label>
                <input id="attractorPosZ" type="range" min="-2" max="2" step="0.05" data-default="0" />
              </div>
            </div>
            <div class="control">
              <label for="gravity">Gravity <span id="gravityVal"></span></label>
              <input id="gravity" type="range" min="-100" max="100" step="0.1" data-default="-0.2" />
            </div>
            <div class="control">
              <label for="windX">Wind X <span id="windXVal"></span></label>
              <input id="windX" type="range" min="-100" max="100" step="0.1" data-default="0" />
            </div>
            <div class="control">
              <label for="windY">Wind Y <span id="windYVal"></span></label>
              <input id="windY" type="range" min="-100" max="100" step="0.1" data-default="0" />
            </div>
            <div class="control">
              <label for="windZ">Wind Z <span id="windZVal"></span></label>
              <input id="windZ" type="range" min="-100" max="100" step="0.1" data-default="0" />
            </div>
            <div class="control">
              <label for="drag">Drag <span id="dragVal"></span></label>
              <input id="drag" type="range" min="0" max="100" step="0.1" data-default="0" />
            </div>
            <div class="control">
              <label for="groundEnabled">Ground Collision</label>
              <button id="groundEnabled" class="pill-toggle" type="button" data-state="on">On</button>
            </div>
            <div id="groundControls" class="control-stack">
              <div class="control">
                <label for="groundLevel">Ground Level <span id="groundLevelVal"></span></label>
                <input id="groundLevel" type="range" min="-2" max="2" step="0.1" data-default="-1" />
              </div>
              <div class="control">
                <label for="bounce">Bounce <span id="bounceVal"></span></label>
                <input id="bounce" type="range" min="0" max="1" step="0.05" data-default="0.2" />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel" data-panel="shading">
        <div class="panel-header">
          <span>Shading</span>
        </div>
        <div class="panel-content">
          <div class="control">
            <label for="shadingEnabled">Shading</label>
            <button id="shadingEnabled" class="pill-toggle" type="button" data-state="on">On</button>
          </div>
          <div id="shadingControls" class="control-stack">
            <div class="control">
              <label for="baseColor">Light Color <span id="baseColorVal"></span></label>
              <input id="baseColor" type="color" />
            </div>
            <div class="control">
              <label for="lightIntensity">Intensity <span id="lightIntensityVal"></span></label>
              <input id="lightIntensity" type="range" min="0" max="3" step="0.1" data-default="1.2" />
            </div>
            <div class="control">
              <label for="lightPosX">Light X <span id="lightPosXVal"></span></label>
              <input id="lightPosX" type="range" min="-2" max="2" step="0.05" data-default="0" />
            </div>
            <div class="control">
              <label for="lightPosY">Light Y <span id="lightPosYVal"></span></label>
              <input id="lightPosY" type="range" min="-2" max="2" step="0.05" data-default="1" />
            </div>
            <div class="control">
              <label for="lightPosZ">Light Z <span id="lightPosZVal"></span></label>
              <input id="lightPosZ" type="range" min="-2" max="2" step="0.05" data-default="0.3" />
            </div>
            <div class="control">
              <label for="lightAzimuth">Azimuth <span id="lightAzimuthVal"></span></label>
              <input id="lightAzimuth" type="range" min="0" max="360" step="1" data-default="0" />
            </div>
            <div class="control">
              <label for="lightElevation">Elevation <span id="lightElevationVal"></span></label>
              <input id="lightElevation" type="range" min="-10" max="90" step="1" data-default="70" />
            </div>
          </div>
        </div>
      </div>

      <div class="panel" data-panel="camera">
        <div class="panel-header">
          <span>Camera</span>
        </div>
        <div class="panel-content">
          <div class="control">
            <label for="dofEnabled">DOF</label>
            <button id="dofEnabled" class="pill-toggle" type="button" data-state="on">On</button>
          </div>
          <div id="dofControls" class="control-stack">
            <div class="control">
              <label for="focusDepth">Focus Depth <span id="focusDepthVal"></span></label>
              <input id="focusDepth" type="range" min="-6" max="6" step="0.1" data-default="0" />
            </div>
            <div class="control">
              <label for="focusRange">Focus Range <span id="focusRangeVal"></span></label>
              <input id="focusRange" type="range" min="0.1" max="3" step="0.1" data-default="0.8" />
            </div>
            <div class="control">
              <label for="aperture">Aperture <span id="apertureVal"></span></label>
              <input id="aperture" type="range" min="0" max="10" step="0.1" data-default="7" />
            </div>
            <div class="control select-control">
              <label for="dofMode">DOF Mode</label>
              <select id="dofMode">
                <option value="bokeh">Bokeh</option>
                <option value="physical">Physical Lens</option>
              </select>
            </div>
            <div class="control">
              <label for="focusOverlay">Focus Overlay</label>
              <button id="focusOverlay" class="pill-toggle" type="button" data-state="off">Off</button>
            </div>
            <div class="control">
              <label for="bloomStrength">Bloom Strength <span id="bloomStrengthVal"></span></label>
              <input id="bloomStrength" type="range" min="0" max="2" step="0.05" data-default="0.3" />
            </div>
            <div class="control">
              <label for="bloomThreshold">Bloom Threshold <span id="bloomThresholdVal"></span></label>
              <input id="bloomThreshold" type="range" min="0" max="1.5" step="0.05" data-default="0.8" />
            </div>
            <div class="control">
              <label for="exposure">Exposure <span id="exposureVal"></span></label>
              <input id="exposure" type="range" min="0.2" max="3" step="0.05" data-default="1.2" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <script type="module" src="./main.js"></script>
  </body>
</html>

